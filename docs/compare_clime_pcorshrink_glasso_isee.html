<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Kushal K Dey" />

<meta name="date" content="2018-06-30" />

<title>CLIME, pCorShrink and ISEE comparison</title>

<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<link rel="stylesheet" href="cosmo.css" type="text/css" />

</head>

<body>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:100,300,400,600" rel="stylesheet" type="text/css">
    <link href="../docs/cosmo.css" rel="stylesheet">
    <link href="../docs/cosmo.min.css" rel="stylesheet">
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="../docs/bootstrap/js/bootstrap.min.js"></script>

<body>

<div class = "nav" align = "middle">
<div class= "p1"></div>
<p>
  <a class="btn btn-large btn btn-primary" type="button" href = "index.html">CorShrink</a>
  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;
  <a class="btn btn-large btn btn-primary" type="button" href = "demo.html">DEMO</a>
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "workflow_project.html">WORKFLOW</a>
  &nbsp &nbsp
  <a class="btn btn-large btn btn-primary" type="button" href = "https://github.com/kkdey/CorShrink">R PACKAGE</a>
 </p>
</div>
<!-- <div class="nav">
  <a href="index.html">Home page</a> &nbsp &nbsp
  <a href="musings.html">Musings</a> &nbsp &nbsp
  <a href="town.html">My town</a> &nbsp &nbsp
  <a href="links.html">Links</a>
</div> -->

<!-- Main content -->
</body>
</html>


<h1 class="title toc-ignore">CLIME, pCorShrink and ISEE comparison</h1>
<h4 class="author"><em>Kushal K Dey</em></h4>
<h4 class="date"><em>June 30, 2018</em></h4>


<div id="TOC">
<ul>
<li><a href="#packages">Packages</a></li>
<li><a href="#hub-correlation">Hub correlation</a></li>
<li><a href="#toeplitz-correlation">Toeplitz correlation</a></li>
<li><a href="#banded-precision-matrix-1">Banded Precision Matrix 1</a></li>
<li><a href="#banded-precision-matrix-2">Banded Precision Matrix 2</a></li>
<li><a href="#aggregating-all-plots">Aggregating all plots</a></li>
</ul>
</div>

<p>In this script, we compare the Frobenius norm distance of the estimated partial correlation matrices from CLIME, GLASSO, ISEE and pCorShrink approaches, with that of the original partial correlation matrix for different structural assumptions on the original correlation matrix.</p>
<div id="packages" class="section level2">
<h2>Packages</h2>
<pre class="r"><code>library(MASS) 
library(Matrix)
library(CorShrink)
library(corpcor)
library(glasso)
library(scio)
library(ggplot2)
library(scales)
library(gridExtra)</code></pre>
</div>
<div id="hub-correlation" class="section level2">
<h2>Hub correlation</h2>
<pre class="r"><code>frobs_list &lt;- get(load(&quot;../shared_output/pcorshrink/frob_dist_hub.rda&quot;))</code></pre>
<pre class="r"><code>n_vec = c(30, 50, 100, 1000)
M = 30

p_list &lt;- list()
for(n in 1:4){
  df &lt;- data.frame(&quot;method&quot; = factor(c(rep(&quot;empirical&quot;, M), rep(&quot;isee_X&quot;, M), 
                                     rep(&quot;isee&quot;, M), 
                                     rep(&quot;pcorshrink_lasso&quot;, M),
                                     rep(&quot;CLIME&quot;, M),
                                     rep(&quot;glasso-0.01&quot;, M),
                                     rep(&quot;glasso-0.1&quot;, M),
                                     rep(&quot;glasso-0.5&quot;, M),
                                     rep(&quot;glasso-1&quot;, M)), 
                              levels = c(&quot;empirical&quot;, &quot;isee_X&quot;,
                                        &quot;isee&quot;,
                                        &quot;pcorshrink_lasso&quot;,
                                        &quot;CLIME&quot;,
                                        &quot;glasso-0.01&quot;,
                                        &quot;glasso-0.1&quot;,
                                        &quot;glasso-0.5&quot;,
                                        &quot;glasso-1&quot;)),
                 &quot;distance&quot; = log(c(frobs_list$empirical[n,],
                                    frobs_list$isee_X[n,],
                                    frobs_list$isee[n,],
                                    frobs_list$pcorshrink_lasso[n,],
                                    frobs_list$clime[n,],
                                    frobs_list$glasso_0_01[n,],
                                    frobs_list$glasso_0_1[n,],
                                    frobs_list$glasso_0_5[n,],
                                    frobs_list$glasso_1[n,])))
p &lt;- ggplot(df, aes(method, distance, color = method)) + ylab(&quot;log(distance)&quot;)
p_list[[n]] &lt;- p + geom_boxplot() + theme_bw() + theme(legend.position = &quot;none&quot;) +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) + ggtitle(paste0(&quot;n = &quot;, n_vec[n], &quot; p = &quot;, 100)) +scale_y_continuous(breaks= pretty_breaks())
}</code></pre>
<pre class="r"><code>grid.arrange(p_list[[1]], p_list[[2]], p_list[[3]], p_list[[4]], nrow = 2,  ncol=2, as.table=TRUE)</code></pre>
<p><img src="compare_clime_pcorshrink_glasso_isee_files/figure-html/unnamed-chunk-4-1.png" width="960" /></p>
</div>
<div id="toeplitz-correlation" class="section level2">
<h2>Toeplitz correlation</h2>
<pre class="r"><code>frobs_list &lt;- get(load(&quot;../shared_output/pcorshrink/frob_dist_toeplitz.rda&quot;))</code></pre>
<pre class="r"><code>n_vec = c(30, 50, 100, 1000)
M = 30

for(n in 1:4){
  df &lt;- data.frame(&quot;method&quot; = factor(c(rep(&quot;empirical&quot;, M), rep(&quot;isee_X&quot;, M), 
                                     rep(&quot;isee&quot;, M), 
                                     rep(&quot;pcorshrink_lasso&quot;, M),
                                     rep(&quot;CLIME&quot;, M),
                                     rep(&quot;glasso-0.01&quot;, M),
                                     rep(&quot;glasso-0.1&quot;, M),
                                     rep(&quot;glasso-0.5&quot;, M),
                                     rep(&quot;glasso-1&quot;, M)), 
                              levels = c(&quot;empirical&quot;, &quot;isee_X&quot;,
                                        &quot;isee&quot;,
                                        &quot;pcorshrink_lasso&quot;,
                                        &quot;CLIME&quot;,
                                        &quot;glasso-0.01&quot;,
                                        &quot;glasso-0.1&quot;,
                                        &quot;glasso-0.5&quot;,
                                        &quot;glasso-1&quot;)),
                 &quot;distance&quot; = log(c(frobs_list$empirical[n,],
                                    frobs_list$isee_X[n,],
                                    frobs_list$isee[n,],
                                    frobs_list$pcorshrink_lasso[n,],
                                    frobs_list$clime[n,],
                                    frobs_list$glasso_0_01[n,],
                                    frobs_list$glasso_0_1[n,],
                                    frobs_list$glasso_0_5[n,],
                                    frobs_list$glasso_1[n,])))
p &lt;- ggplot(df, aes(method, distance, color = method)) + ylab(&quot;log(distance)&quot;)
p_list[[(4+n)]] &lt;- p + geom_boxplot() + theme_bw() + theme(legend.position = &quot;none&quot;) +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) + ggtitle(paste0(&quot;n = &quot;, n_vec[n], &quot; p = &quot;, 100)) +scale_y_continuous(breaks= pretty_breaks())
}</code></pre>
<pre class="r"><code>grid.arrange(p_list[[5]], p_list[[6]], p_list[[7]], p_list[[8]], nrow = 2,  ncol=2, as.table=TRUE)</code></pre>
<p><img src="compare_clime_pcorshrink_glasso_isee_files/figure-html/unnamed-chunk-7-1.png" width="960" /></p>
</div>
<div id="banded-precision-matrix-1" class="section level2">
<h2>Banded Precision Matrix 1</h2>
<pre class="r"><code>frobs_list &lt;- get(load(&quot;../shared_output/pcorshrink/frob_dist_banded_precision.rda&quot;))</code></pre>
<pre class="r"><code>n_vec = c(30, 50, 100, 1000)
M = 30

for(n in 1:4){
  df &lt;- data.frame(&quot;method&quot; = factor(c(rep(&quot;empirical&quot;, M), rep(&quot;isee_X&quot;, M), 
                                     rep(&quot;isee&quot;, M), 
                                     rep(&quot;pcorshrink_lasso&quot;, M),
                                     rep(&quot;CLIME&quot;, M),
                                     rep(&quot;glasso-0.01&quot;, M),
                                     rep(&quot;glasso-0.1&quot;, M),
                                     rep(&quot;glasso-0.5&quot;, M),
                                     rep(&quot;glasso-1&quot;, M)), 
                              levels = c(&quot;empirical&quot;, &quot;isee_X&quot;,
                                        &quot;isee&quot;,
                                        &quot;pcorshrink_lasso&quot;,
                                        &quot;CLIME&quot;,
                                        &quot;glasso-0.01&quot;,
                                        &quot;glasso-0.1&quot;,
                                        &quot;glasso-0.5&quot;,
                                        &quot;glasso-1&quot;)),
                 &quot;distance&quot; = log(c(frobs_list$empirical[n,],
                                    frobs_list$isee_X[n,],
                                    frobs_list$isee[n,],
                                    frobs_list$pcorshrink_lasso[n,],
                                    frobs_list$clime[n,],
                                    frobs_list$glasso_0_01[n,],
                                    frobs_list$glasso_0_1[n,],
                                    frobs_list$glasso_0_5[n,],
                                    frobs_list$glasso_1[n,])))
p &lt;- ggplot(df, aes(method, distance, color = method)) + ylab(&quot;log(distance)&quot;)
p_list[[(8+n)]] &lt;- p + geom_boxplot() + theme_bw() + theme(legend.position = &quot;none&quot;) +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) + ggtitle(paste0(&quot;n = &quot;, n_vec[n], &quot; p = &quot;, 100)) +scale_y_continuous(breaks= pretty_breaks())
}</code></pre>
<pre class="r"><code>grid.arrange(p_list[[9]], p_list[[10]], p_list[[11]], p_list[[12]], nrow = 2,  ncol=2, as.table=TRUE)</code></pre>
<p><img src="compare_clime_pcorshrink_glasso_isee_files/figure-html/unnamed-chunk-10-1.png" width="960" /></p>
</div>
<div id="banded-precision-matrix-2" class="section level2">
<h2>Banded Precision Matrix 2</h2>
<pre class="r"><code>p &lt;- ggplot(df, aes(method, distance, color = method)) + ylab(&quot;log(distance)&quot;)
p + geom_boxplot() + theme_bw() +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) + ggtitle(paste0(&quot;n = &quot;, n_vec[n], &quot; p = &quot;, 100)) +scale_y_continuous(breaks= pretty_breaks())</code></pre>
<p><img src="compare_clime_pcorshrink_glasso_isee_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="aggregating-all-plots" class="section level2">
<h2>Aggregating all plots</h2>
<pre class="r"><code>grid.arrange(p_list[[1]], p_list[[2]], p_list[[3]], p_list[[4]], 
             p_list[[5]], p_list[[6]], p_list[[7]], p_list[[8]],
             p_list[[9]], p_list[[10]], p_list[[11]], p_list[[12]],
             nrow = 4,  ncol=3, as.table = FALSE)</code></pre>
<p><img src="compare_clime_pcorshrink_glasso_isee_files/figure-html/unnamed-chunk-15-1.png" width="960" /></p>
</div>

<hr>
<p>
    This <a href="http://rmarkdown.rstudio.com">R Markdown</a> site was created with <a href="https://github.com/jdblischak/workflowr">workflowr</a>
</p>
<hr>

<!-- To enable disqus, uncomment the section below and provide your disqus_shortname -->

<!-- disqus
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rmarkdown'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
-->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
